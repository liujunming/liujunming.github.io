
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>通过Linux内核使用RDT | L</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
    
    <meta name="author" content="liujunming">
    
    <meta name="description" content="Intel RDT特性详解介绍了RDT的基本概念，以及通过PQOS工具使用RDT。本文主要是介绍如何通过内核来使用RDT。
我的内核版本为4.14.32，内核对RDT的支持有版本要求，详情请参考OS interface feature support。cpu型号为Intel Xeon E5 2650">
    
    
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="ljm11636" />
    <meta name="twitter:title" content="通过Linux内核使用RDT | L" />
      
    
    
    <link rel="alternate" href="/atom.xml" title="L" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/pacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/pacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
    
</head>

  <body>
    <header>
      <div>
		

		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.svg" alt="L" title="L"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="L">L</a></h1>
				<h2 class="blog-motto">make it simple, make it happen.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="text" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:liujunming.top">
					</form>
					
					</li>
				</ul>
			</nav>
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/04/18/通过Linux内核使用RDT/" title="通过Linux内核使用RDT" itemprop="url">通过Linux内核使用RDT</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://liujunming.github.io" title="liujunming">liujunming</a>
    </p>
  <p class="article-time">
    <time datetime="2018-04-18T06:40:00.000Z" itemprop="datePublished">2018-04-18</time>
    更新日期:<time datetime="2018-06-25T14:52:44.000Z" itemprop="dateModified">2018-06-25</time>
    
  </p>
</header>
	<div class="article-content">
		
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#内核编译"><span class="toc-number">1.</span> <span class="toc-text">内核编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#挂载文件系统"><span class="toc-number">2.</span> <span class="toc-text">挂载文件系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Resource-alloc-and-monitor-groups"><span class="toc-number">3.</span> <span class="toc-text">Resource alloc and monitor groups</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource-groups"><span class="toc-number">3.1.</span> <span class="toc-text">Resource groups</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#All-groups-contain-the-following-files"><span class="toc-number">3.2.</span> <span class="toc-text">All groups contain the following files</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#When-control-is-enabled"><span class="toc-number">3.2.1.</span> <span class="toc-text">When control is enabled</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#When-monitoring-is-enabled"><span class="toc-number">3.2.2.</span> <span class="toc-text">When monitoring is enabled</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Examples-for-RDT-allocation-usage"><span class="toc-number">4.</span> <span class="toc-text">Examples for RDT allocation usage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Examples-for-RDT-Monitoring-along-with-allocation-usage"><span class="toc-number">5.</span> <span class="toc-text">Examples for RDT Monitoring along with allocation usage</span></a></li></ol>
		</div>
		
		<p><a href="http://liujunming.top/2018/04/11/Intel-RDT%E7%89%B9%E6%80%A7%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener">Intel RDT特性详解</a>介绍了RDT的基本概念，以及通过PQOS工具使用RDT。本文主要是介绍如何通过内核来使用RDT。</p>
<p>我的内核版本为<a href="https://mirrors.edge.kernel.org/pub/linux/kernel/v4.x/linux-4.14.32.tar.gz" target="_blank" rel="noopener">4.14.32</a>，内核对RDT的支持有版本要求，详情请参考<a href="https://github.com/intel/intel-cmt-cat/wiki" target="_blank" rel="noopener">OS interface feature support</a>。cpu型号为Intel Xeon E5 2650 v4，共两个cpu。</p>
<h2 id="内核编译"><a href="#内核编译" class="headerlink" title="内核编译"></a>内核编译</h2><p>RDT技术的选项位于“processor type and feature” -&gt; “Intel Resource Director Technology Allocation support”。</p>
<p><img src="/images/2018/4/9.png" alt=""></p>
<p><img src="/images/2018/4/10.png" alt=""></p>
<h2 id="挂载文件系统"><a href="#挂载文件系统" class="headerlink" title="挂载文件系统"></a>挂载文件系统</h2><p><code>mount -t resctrl resctrl /sys/fs/resctrl</code></p>
<h2 id="Resource-alloc-and-monitor-groups"><a href="#Resource-alloc-and-monitor-groups" class="headerlink" title="Resource alloc and monitor groups"></a>Resource alloc and monitor groups</h2><h3 id="Resource-groups"><a href="#Resource-groups" class="headerlink" title="Resource groups"></a>Resource groups</h3><ul>
<li>CTRL_MON groups</li>
</ul>
<p>Resource groups are represented as directories in the resctrl file system.  The default group is the root directory which, immediately after mounting, owns all the tasks and cpus in the system and can make full use of all resources.<br>On a system with RDT control features additional directories can be created in the root directory that specify different amounts of each resource. The root and these additional top level directories are referred to as “CTRL_MON” groups.</p>
<ul>
<li>MON groups</li>
</ul>
<p>On a system with RDT monitoring the root directory and other top level directories contain a directory named “mon_groups” in which additional directories can be created to monitor subsets of tasks in the CTRL_MON group that is their ancestor. These are called “MON” groups.</p>
<h3 id="All-groups-contain-the-following-files"><a href="#All-groups-contain-the-following-files" class="headerlink" title="All groups contain the following files"></a>All groups contain the following files</h3><ul>
<li>tasks<br>Reading this file shows the list of all tasks that belong to this group. Writing a task id to the file will add a task to the group.</li>
<li>cpus<br>是一个16进制整数，每一个bit代表一个CPU核心，比如我这里有10个“f”，意味着该机器有40个core。</li>
</ul>
<h4 id="When-control-is-enabled"><a href="#When-control-is-enabled" class="headerlink" title="When control is enabled"></a>When control is enabled</h4><p>When control is enabled all CTRL_MON groups will also contain:</p>
<ul>
<li>schemata<br>策略表，每个策略一行，格式为：<br>L3: cache_id0 = cbm; cache_id1 = cbm<br>这里的cache id可以理解为CPU id，而后面的cbm是分配给cpu的L3单元数量。我这块CPU每个socket会有11个L3 cache 单元也就是7ff。就是指在cpu cache的每个组内，group可以使用的cache line的数量。</li>
</ul>
<h4 id="When-monitoring-is-enabled"><a href="#When-monitoring-is-enabled" class="headerlink" title="When monitoring is enabled"></a>When monitoring is enabled</h4><p>When monitoring is enabled all MON groups will also contain:</p>
<ul>
<li>mon_data<br>This contains a set of files organized by L3 domain and by RDT event. E.g. on a system with two L3 domains there will be subdirectories “mon_L3_00” and “mon_L3_01”.    Each of these directories have one file per event (e.g. “llc_occupancy”, “mbm_total_bytes”, and “mbm_local_bytes”). In a MON group these files provide a read out of the current value of the event for all tasks in the group(在MON组中，这些文件为组中的所有任务提供读取当前事件的值).</li>
</ul>
<h2 id="Examples-for-RDT-allocation-usage"><a href="#Examples-for-RDT-allocation-usage" class="headerlink" title="Examples for RDT allocation usage"></a>Examples for RDT allocation usage</h2><p>具体例子请参考<a href="https://www.kernel.org/doc/Documentation/x86/intel_rdt_ui.txt" target="_blank" rel="noopener">intel_rdt_ui.txt</a></p>
<h2 id="Examples-for-RDT-Monitoring-along-with-allocation-usage"><a href="#Examples-for-RDT-Monitoring-along-with-allocation-usage" class="headerlink" title="Examples for RDT Monitoring along with allocation usage"></a>Examples for RDT Monitoring along with allocation usage</h2><p>具体例子请参考<a href="https://www.kernel.org/doc/Documentation/x86/intel_rdt_ui.txt" target="_blank" rel="noopener">intel_rdt_ui.txt</a></p>
<hr>
<p>参考资料：</p>
<ol>
<li><a href="https://www.kernel.org/doc/Documentation/x86/intel_rdt_ui.txt" target="_blank" rel="noopener">intel_rdt_ui.txt</a></li>
<li><a href="http://www.litrin.net/2017/02/21/linux-4-10%E4%B8%ADcat%E7%9A%84%E4%BD%BF%E7%94%A8/2/" target="_blank" rel="noopener">Linux 4.10中CAT的使用</a></li>
</ol>
  
	</div>
		<footer class="article-footer clearfix">

  <div class="article-tags">
  
  <span></span> <a href="/tags/计算机系统/">计算机系统</a>
  </div>


<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/计算机系统/">计算机系统</a>
</div>



<div class="article-share" id="share">

  <div data-url="http://liujunming.github.io/2018/04/18/通过Linux内核使用RDT/" data-title="通过Linux内核使用RDT | L" data-tsina="null" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2018/04/19/自我总结/" title="自我总结">
  <strong>PREVIOUS:</strong><br/>
  <span>
  自我总结</span>
</a>
</div>


<div class="next">
<a href="/2018/04/17/分布式系统资料/"  title="分布式系统资料">
 <strong>NEXT:</strong><br/> 
 <span>分布式系统资料
</span>
</a>
</div>

</nav>

	
<section id="comment">
  
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  
</section>



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#内核编译"><span class="toc-number">1.</span> <span class="toc-text">内核编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#挂载文件系统"><span class="toc-number">2.</span> <span class="toc-text">挂载文件系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Resource-alloc-and-monitor-groups"><span class="toc-number">3.</span> <span class="toc-text">Resource alloc and monitor groups</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource-groups"><span class="toc-number">3.1.</span> <span class="toc-text">Resource groups</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#All-groups-contain-the-following-files"><span class="toc-number">3.2.</span> <span class="toc-text">All groups contain the following files</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#When-control-is-enabled"><span class="toc-number">3.2.1.</span> <span class="toc-text">When control is enabled</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#When-monitoring-is-enabled"><span class="toc-number">3.2.2.</span> <span class="toc-text">When monitoring is enabled</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Examples-for-RDT-allocation-usage"><span class="toc-number">4.</span> <span class="toc-text">Examples for RDT allocation usage</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Examples-for-RDT-Monitoring-along-with-allocation-usage"><span class="toc-number">5.</span> <span class="toc-text">Examples for RDT Monitoring along with allocation usage</span></a></li></ol>
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/C语言/" title="C语言">C语言<sup>3</sup></a></li>
		
			<li><a href="/categories/Kernel/" title="Kernel">Kernel<sup>8</sup></a></li>
		
			<li><a href="/categories/benchmark/" title="benchmark">benchmark<sup>4</sup></a></li>
		
			<li><a href="/categories/kv-store/" title="kv store">kv store<sup>2</sup></a></li>
		
			<li><a href="/categories/linux/" title="linux">linux<sup>3</sup></a></li>
		
			<li><a href="/categories/python/" title="python">python<sup>1</sup></a></li>
		
			<li><a href="/categories/scala/" title="scala">scala<sup>2</sup></a></li>
		
			<li><a href="/categories/spark/" title="spark">spark<sup>2</sup></a></li>
		
			<li><a href="/categories/内存管理/" title="内存管理">内存管理<sup>20</sup></a></li>
		
			<li><a href="/categories/分布式系统/" title="分布式系统">分布式系统<sup>5</sup></a></li>
		
			<li><a href="/categories/存储/" title="存储">存储<sup>1</sup></a></li>
		
			<li><a href="/categories/容器/" title="容器">容器<sup>2</sup></a></li>
		
			<li><a href="/categories/工具/" title="工具">工具<sup>4</sup></a></li>
		
			<li><a href="/categories/操作系统/" title="操作系统">操作系统<sup>3</sup></a></li>
		
			<li><a href="/categories/数据结构/" title="数据结构">数据结构<sup>8</sup></a></li>
		
			<li><a href="/categories/文件系统/" title="文件系统">文件系统<sup>4</sup></a></li>
		
			<li><a href="/categories/算法/" title="算法">算法<sup>5</sup></a></li>
		
			<li><a href="/categories/经验/" title="经验">经验<sup>9</sup></a></li>
		
			<li><a href="/categories/虚拟化/" title="虚拟化">虚拟化<sup>6</sup></a></li>
		
			<li><a href="/categories/计算机系统/" title="计算机系统">计算机系统<sup>8</sup></a></li>
		
			<li><a href="/categories/计算机网络/" title="计算机网络">计算机网络<sup>2</sup></a></li>
		
			<li><a href="/categories/软件工程/" title="软件工程">软件工程<sup>24</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/C语言/" title="C语言">C语言<sup>3</sup></a></li>
		
			<li><a href="/tags/KVM/" title="KVM">KVM<sup>4</sup></a></li>
		
			<li><a href="/tags/Kernel/" title="Kernel">Kernel<sup>26</sup></a></li>
		
			<li><a href="/tags/benchmark/" title="benchmark">benchmark<sup>4</sup></a></li>
		
			<li><a href="/tags/docker/" title="docker">docker<sup>2</sup></a></li>
		
			<li><a href="/tags/ksm/" title="ksm">ksm<sup>1</sup></a></li>
		
			<li><a href="/tags/leveldb/" title="leveldb">leveldb<sup>2</sup></a></li>
		
			<li><a href="/tags/linux/" title="linux">linux<sup>5</sup></a></li>
		
			<li><a href="/tags/python/" title="python">python<sup>1</sup></a></li>
		
			<li><a href="/tags/scala/" title="scala">scala<sup>2</sup></a></li>
		
			<li><a href="/tags/spark/" title="spark">spark<sup>2</sup></a></li>
		
			<li><a href="/tags/xv6/" title="xv6">xv6<sup>2</sup></a></li>
		
			<li><a href="/tags/内存管理/" title="内存管理">内存管理<sup>21</sup></a></li>
		
			<li><a href="/tags/分布式系统/" title="分布式系统">分布式系统<sup>5</sup></a></li>
		
			<li><a href="/tags/存储/" title="存储">存储<sup>1</sup></a></li>
		
			<li><a href="/tags/容器/" title="容器">容器<sup>2</sup></a></li>
		
			<li><a href="/tags/工具/" title="工具">工具<sup>4</sup></a></li>
		
			<li><a href="/tags/操作系统/" title="操作系统">操作系统<sup>3</sup></a></li>
		
			<li><a href="/tags/数据结构/" title="数据结构">数据结构<sup>8</sup></a></li>
		
			<li><a href="/tags/文件系统/" title="文件系统">文件系统<sup>4</sup></a></li>
		
		</ul>
</div>


  
  <div class="archiveslist">
    <p class="asidetitle"><a href="/archives">归档</a></p>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">7</span></li></ul>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
      <li><a href="http://home.ustc.edu.cn/~ljm0910" target="_blank">ustc个人主页</a></li>
      <li><a href="http://home.ustc.edu.cn/~ljm0910/paper.html" target="_blank">论文整理</a></li>
      <li><a href="https://dremy.cn/" target="_blank">Dremy's Blog</a></li>
    </ul>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello, I am Liujunming <br/>
			This is my blog</p>
	</section>
	 
	<div class="social-font clearfix">
		
		<a href="http://weibo.com/u/3947739858?is_all=1" target="_blank" title="weibo"></a>
		
		
		<a href="https://twitter.com/ljm11636" target="_blank" title="twitter"></a>
		
		
		<a href="https://github.com/liujunming" target="_blank" title="github"></a>
		
		
		<a href="https://www.facebook.com/profile.php?id=100007411297476" target="_blank" title="facebook"></a>
		
		
	</div>
		<p class="copyright">Copyright © 2015-2018 <br>liujunming<br>All Right Reserved
		</p>
</div>
</footer>
    <script src="/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>



    <script type="text/javascript">
    var disqus_shortname = 'junmingliu';
    var disqus_config = function () {
        this.page.url = 'http://liujunming.github.io/2018/04/18/通过Linux内核使用RDT/';
        this.page.identifier = '/2018/04/18/通过Linux内核使用RDT/';
        this.page.title = '通过Linux内核使用RDT';
    };
    (function(){
      var d = document;
      var dsq = d.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (d.head || d.body).appendChild(dsq);
    })();
    </script>






  </body>
</html>
